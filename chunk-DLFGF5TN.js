import{a as w}from"./chunk-B4OOJPRQ.js";import{Ba as i,Ga as s,Nb as b,Ua as r,Va as c,Xa as l,Ya as p,_a as u,bc as f,eb as m,v as d}from"./chunk-CL3FEXF7.js";var h=class a{constructor(t,o){this.voteControllerService=t;this.authService=o}countdownDisplay="";endDate=new Date("May 28, 2025 00:00:00").getTime();countdownSubscription;authSubscription;ngOnInit(){this.countdownSubscription=d(121*1e3).subscribe(()=>{this.updateCountdown()}),this.updateCountdown()}ngOnDestroy(){this.countdownSubscription&&this.countdownSubscription.unsubscribe(),this.authSubscription&&this.authSubscription.unsubscribe()}downloadExcel(){this.voteControllerService.exportToExcel().subscribe({next:t=>{let o=new Blob([t],{type:"application/vnd.ms-excel"}),e=window.URL.createObjectURL(o),n=document.createElement("a");n.href=e,n.download="risultati_voto.xlsx",document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(e)},error:t=>{console.error("Errore durante il download:",t)}})}updateCountdown(){let t=new Date().getTime(),o=this.endDate-t;if(o<0){this.countdownDisplay="Scaduto";return}let e=Math.floor(o/(1e3*60*60*24)),n=Math.floor(o%(1e3*60*60*24)/(1e3*60*60)),v=Math.floor(o%(1e3*60*60)/(1e3*60)),g=Math.floor(o%(1e3*60)/1e3);this.countdownDisplay=`${e}g ${n}h ${v}m ${g}s`}static \u0275fac=function(o){return new(o||a)(i(f),i(w))};static \u0275cmp=s({type:a,selectors:[["app-download"]],decls:4,vars:0,consts:[[1,"download-container"],[1,"download-button",3,"click"]],template:function(o,e){o&1&&(r(0,"div",0),l(1),r(2,"button",1),u("click",function(){return e.downloadExcel()}),m(3," Scarica Report Excel "),c(),p(),c())},dependencies:[b],styles:[".download-container[_ngcontent-%COMP%]{padding:20px;text-align:center}.download-button[_ngcontent-%COMP%]{padding:10px 20px;background-color:#4caf50;color:#fff;border:none;border-radius:4px;cursor:pointer}.download-button[_ngcontent-%COMP%]:hover{background-color:#45a049}.download-button[_ngcontent-%COMP%]:disabled{background-color:#ccc;cursor:not-allowed}.disclaimer[_ngcontent-%COMP%]{background-color:#f8f9fa;border:1px solid #e9ecef;border-radius:4px;padding:15px;margin-top:20px}.disclaimer[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:10px;color:#495057}.countdown[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;color:#dc3545;margin:10px 0}"]})};export{h as DownloadComponent};
