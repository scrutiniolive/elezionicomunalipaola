import{c as P,e as D,i as y,j as w,k as x,m as I}from"./chunk-5LM5OEFH.js";import{a as E,b as z,c as R}from"./chunk-XHZ73YMA.js";import{Aa as m,Fa as p,Gb as _,Ib as O,Ja as u,Qa as a,Ta as r,Ua as o,Ub as M,Va as c,Vb as v,Za as h,db as l,fb as C,ib as f,jb as S,kb as b,v as g,wa as i}from"./chunk-FTSSXSA7.js";function A(s,e){if(s&1&&(r(0,"option",16),l(1),o()),s&2){let n=e.$implicit;a("value",n.id),i(),C(" ",n.name," ")}}var k=class s{constructor(e,n){this.dashboardControllerService=e;this.electionDisplayControllerService=n}liveState="-";numSection="-";party="-";votes="-";sections=[];selectedSection=-1;selectedSectionData=null;updateSubscription;ngOnInit(){this.loadSections(),this.setupAutoRefresh()}loadSections(){this.electionDisplayControllerService.allSectionInfo().subscribe({next:e=>{this.sections=this.mapSectionDtoToSectionData(e),this.sections.length>0&&(this.selectedSection=this.sections[0].id,this.onSectionChange())},error:e=>console.error("Errore nel caricamento delle sezioni:",e)})}mapSectionDtoToSectionData(e){return e.map(n=>({id:n.id||0,name:n.name||"",state:n.ballotOpen?"Aperto":"Chiuso",votes:"-"}))}onSectionChange(){this.selectedSection?this.electionDisplayControllerService.sectionInfo(this.selectedSection).subscribe({next:e=>{this.selectedSectionData={id:e.id,name:e.name||"",state:e.ballotOpen?"Aperto":"Chiuso",votes:"-"}},error:e=>console.error("Errore nel caricamento dei dettagli sezione:",e)}):this.selectedSectionData=null}loadAllData(){this.dashboardControllerService.globalStats().subscribe({next:e=>{this.liveState=e.countingInProgress?"In Diretta":"Terminato",this.numSection=e.sectionClosed?(17-e.sectionClosed).toString()+" di 17":"-",this.party=e.leadPartyList?e.leadPartyList:"-",this.votes=e.totalVotes?e.totalVotes.toString():"-"},error:e=>console.error("Errore nel caricamento dei dati:",e)})}setupAutoRefresh(){this.updateSubscription=g(3e5).subscribe(()=>{this.loadAllData()})}ngOnDestroy(){this.updateSubscription&&this.updateSubscription.unsubscribe()}static \u0275fac=function(n){return new(n||s)(m(M),m(v))};static \u0275cmp=p({type:s,selectors:[["app-seat-results"]],decls:23,vars:13,consts:[[1,"dashboard"],[1,"card-container"],[1,"selector-card"],[1,"icon"],[1,"fa-solid","fa-person-booth"],[1,"content"],[3,"ngModelChange","change","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"title","value","icon","prefix"],[1,"chart-container"],[1,"chart-row"],[1,"chart-col"],["dataSource","seat-mayors","title","Voti Candidati a Sindaco",3,"sectionId"],["dataSource","seat-votes","title","Schede Elettorali",3,"sectionId"],["dataSource","seat-councillors",3,"sectionId"],[3,"value"]],template:function(n,t){n&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),c(4,"i",4),o(),r(5,"div",5)(6,"h3"),l(7,"Seleziona Sezione"),o(),r(8,"select",6),b("ngModelChange",function(d){return S(t.selectedSection,d)||(t.selectedSection=d),d}),h("change",function(){return t.onSectionChange()}),r(9,"option",7),l(10,"Tutte le sezioni"),o(),u(11,A,2,2,"option",8),o()()(),c(12,"app-counter-card",9)(13,"app-counter-card",9),o(),r(14,"div",10)(15,"div",11)(16,"div",12),c(17,"app-pie-chart",13),o(),r(18,"div",12),c(19,"app-pie-chart",14),o()(),r(20,"div",11)(21,"div",12),c(22,"app-bar-chart",15),o()()()()),n&2&&(i(8),f("ngModel",t.selectedSection),i(3),a("ngForOf",t.sections),i(),a("title","Stato Seggio")("value",(t.selectedSectionData==null?null:t.selectedSectionData.state)||t.liveState)("icon","tower-broadcast")("prefix",""),i(),a("title","Votanti")("value",(t.selectedSectionData==null?null:t.selectedSectionData.votes)||t.votes)("icon","pencil")("prefix",""),i(4),a("sectionId",t.selectedSectionData==null?null:t.selectedSectionData.id),i(2),a("sectionId",t.selectedSectionData==null?null:t.selectedSectionData.id),i(3),a("sectionId",t.selectedSectionData==null?null:t.selectedSectionData.id))},dependencies:[O,_,I,w,x,y,P,D,E,z,R],styles:[".dashboard[_ngcontent-%COMP%]{padding:.9375rem;font-family:sans-serif;box-sizing:border-box}.dashboard[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin-bottom:1.25rem;color:#2c3e50;font-size:1.5rem}.dashboard[_ngcontent-%COMP%]   .card-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(15.625rem,1fr));gap:1.25rem;margin-bottom:1.875rem}.dashboard[_ngcontent-%COMP%]   .selector-card[_ngcontent-%COMP%], .dashboard   [_nghost-%COMP%]   .counter-card[_ngcontent-%COMP%]{background-color:#fff;border-radius:.5rem;box-shadow:0 .125rem .625rem #0000001a;padding:1.25rem;display:flex;align-items:center;box-sizing:border-box}.dashboard[_ngcontent-%COMP%]   .selector-card[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{background-color:#3498db;color:#fff;width:3.125rem;height:3.125rem;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1.5rem;margin-right:.6875rem;flex-shrink:0}.dashboard[_ngcontent-%COMP%]   .selector-card[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;justify-content:center}.dashboard[_ngcontent-%COMP%]   .selector-card[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:#7f8c8d;font-size:1rem;font-weight:500;margin-bottom:.5rem}.dashboard[_ngcontent-%COMP%]   .selector-card[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:.5rem;border-radius:.25rem;border:.0625rem solid #ddd;font-size:1rem;color:#2c3e50;background-color:#f8f9fa;cursor:pointer}.dashboard[_ngcontent-%COMP%]   .selector-card[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;border-color:#3498db;box-shadow:0 0 0 .125rem #3498db33}.dashboard[_ngcontent-%COMP%]   .selector-card[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:hover{border-color:#3498db}.dashboard[_ngcontent-%COMP%]   .chart-container[_ngcontent-%COMP%]   .chart-row[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1.25rem;margin-bottom:1.25rem}.dashboard[_ngcontent-%COMP%]   .chart-container[_ngcontent-%COMP%]   .chart-row[_ngcontent-%COMP%]   .chart-col[_ngcontent-%COMP%]{flex:1 1 18.75rem;background-color:#fff;border-radius:.5rem;box-shadow:0 .125rem .625rem #0000001a;padding:1.25rem}[_nghost-%COMP%]{display:block;height:100%}.counter-card[_ngcontent-%COMP%]{height:100%;box-sizing:border-box}.counter-card[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{background-color:#3498db;color:#fff;width:3.125rem;height:3.125rem;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1.5rem;margin-right:.6875rem;flex-shrink:0}.counter-card[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:#7f8c8d;font-size:1rem;font-weight:500}.counter-card[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;margin:.3125rem 0 0;color:#2c3e50}@media (max-width: 768px){.dashboard[_ngcontent-%COMP%]{padding:.625rem}.dashboard[_ngcontent-%COMP%]   .card-container[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fit,minmax(12.5rem,1fr));gap:.625rem}.dashboard[_ngcontent-%COMP%]   .chart-container[_ngcontent-%COMP%]   .chart-row[_ngcontent-%COMP%]   .chart-col[_ngcontent-%COMP%]{flex:1 1 100%;padding:.625rem}}@media (max-width: 480px){.dashboard[_ngcontent-%COMP%]   .card-container[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})};export{k as SeatResultsComponent};
