import{a as w}from"./chunk-L7F5CDFN.js";import{Ba as r,Ga as l,Nb as b,Ua as i,Va as c,Xa as s,Ya as p,Zb as f,_a as u,bc as h,eb as m,v as d}from"./chunk-YCY2TLIR.js";var v=class a{constructor(t,o,n){this.voteControllerService=t;this.dashboardControllerService=o;this.authService=n}countdownDisplay="";endDate=new Date("May 28, 2025 00:00:00").getTime();countdownSubscription;authSubscription;ngOnInit(){this.countdownSubscription=d(121*1e3).subscribe(()=>{this.updateCountdown()}),this.updateCountdown()}ngOnDestroy(){this.countdownSubscription&&this.countdownSubscription.unsubscribe(),this.authSubscription&&this.authSubscription.unsubscribe()}downloadExcel(){this.dashboardControllerService.exportToExcel().subscribe({next:t=>{let o=new Blob([t],{type:"application/vnd.ms-excel"}),n=window.URL.createObjectURL(o),e=document.createElement("a");e.href=n,e.download="risultati_voto.xlsx",document.body.appendChild(e),e.click(),document.body.removeChild(e),window.URL.revokeObjectURL(n)},error:t=>{console.error("Errore durante il download:",t)}})}updateCountdown(){let t=new Date().getTime(),o=this.endDate-t;if(o<0){this.countdownDisplay="Scaduto";return}let n=Math.floor(o/(1e3*60*60*24)),e=Math.floor(o%(1e3*60*60*24)/(1e3*60*60)),C=Math.floor(o%(1e3*60*60)/(1e3*60)),g=Math.floor(o%(1e3*60)/1e3);this.countdownDisplay=`${n}g ${e}h ${C}m ${g}s`}static \u0275fac=function(o){return new(o||a)(r(h),r(f),r(w))};static \u0275cmp=l({type:a,selectors:[["app-download"]],decls:4,vars:0,consts:[[1,"download-container"],[1,"download-button",3,"click"]],template:function(o,n){o&1&&(i(0,"div",0),s(1),i(2,"button",1),u("click",function(){return n.downloadExcel()}),m(3," Scarica Report Excel "),c(),p(),c())},dependencies:[b],styles:[".download-container[_ngcontent-%COMP%]{padding:20px;text-align:center}.download-button[_ngcontent-%COMP%]{padding:10px 20px;background-color:#4caf50;color:#fff;border:none;border-radius:4px;cursor:pointer}.download-button[_ngcontent-%COMP%]:hover{background-color:#45a049}.download-button[_ngcontent-%COMP%]:disabled{background-color:#ccc;cursor:not-allowed}.disclaimer[_ngcontent-%COMP%]{background-color:#f8f9fa;border:1px solid #e9ecef;border-radius:4px;padding:15px;margin-top:20px}.disclaimer[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:10px;color:#495057}.countdown[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;color:#dc3545;margin:10px 0}"]})};export{v as DownloadComponent};
